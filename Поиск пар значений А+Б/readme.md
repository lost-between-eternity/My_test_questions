# Стек:  
SQL (+загрузка данных в БД), Excel, Python.  
## Цель:  
Найти для каждого события А пару в виде события В, интервал между которыми не более 3х дней.
## Что сделано:  
Загрузил обе таблицы в свою БД с именами s1 (обращения) – события А и s2 (консультации) – события В.  
В таблице s1 сделал дополнительный столбец max_data, который равен date + 3 дня. Это верхняя граница у события А.  
Сджойнил таблицы по событиям А к В следующим образом:  
А left join В on A.id=B.id and A.date<=B.date and A.date_3>=B.date.  
Что делаем - мы к каждому событию А с интервалом у пользователя с id присоединяем событие, которое попадает в этот интервал.  
Группирую получившуюся таблицу по: date(A), id и добавляю в вывод min(date(B)) - Тем самым для каждого события А у каждого пользователя - берется самое раннее событие В, это необходимо, чтобы исключить кейс когда в один день наступают события А и Б, а в ближайшие три дня есть еще событие В. В этом случае необходимо выбрать только одну связку А+В, а не создать две (т.е. для одного события А присоединить два события В без группировки).
Далее весь запрос оформляется в конструкцию with с присвоением переменной и к ней применяется еще одна группировка, в обратную сторону.  
Группирую полученную таблицу в обратную сторону, по date(B) (она же минимальная), id и добавляю max(date(A)). Тут избавляемся от кейса, когда случилось несколько событий А в трехдневном диапазоне, а для них есть только одно событие В.
В конце отбросил нулевые значения, что бы показать только пользователей с цепочкой событий А+В (обращение + консультация).  
Потом полученный файл выгрузил из программы в формате .csv и конвертировал через python в Excel и оформил.  
